## 线性表 and 非线性表

线性表就是数据排成像一条线一样的结构。每个线性表上的数据最多只有向前和向后两个方向。线性表包含：

* 数组
* 链表
* 队列
* 栈

非线性表指的是数据之间并不是简单的前后关系。非线性表包含：

* 树
  * 二叉树
  * 堆
* 图

## 数组

 在每一种编程语言中，基本都会有数组这种数据类型。不过，数组不仅仅是编程语言中的一种数据类型，还是一种最基本的数据结构。
**数组是一种线性表数据结构。它用一组连续的内存空间，来存储一组具有相同类型的数据。**

数组的特性：

* 支持随机访问：根据下标随机访问的时间复杂度为常量级时间复杂度 O(1)。
* 插入和删除操作效率低：为了保证内存空间的连续性，必须做大量的数据搬移操作。

### 数组插入的时间复杂度分析

假设数组长度为 n，需要往 offset=k 的位置上插入一个数据，那么时间复杂度是多少？

**分析：**

将数据插入到指定 offset 的位置，这个操作的时间复杂度为 O(1)（随机访问）。 因此，重点是考虑数据搬移的时间复杂度。

**结论：**

* 最好情况时间复杂度：插入到末尾，O(1)
* 最坏情况时间复杂度：插入到开头，O(n)
* 平均情况时间复杂度：(1+2+...+n)/n=O(n)

**改进的办法：**

如果是在一个有序数组中，在 offset=k 位置插入一个数据，那么必须按照上面的方法搬移 offset=k 及其之后的数据，也就是时间复杂度仍然是 O(n)。

如果是在一个无序的数组中，在 offset=k 位置插入一个数据，在这种情况下数组只是被当做一个存储数据的集合。因此，为了避免大规模数据的搬移，一个可以改进的办法是，直接将 offset=k  的数据搬移到数组的最后，然后把新的元素直接放到 offset=k 的位置上。这种场景下，在 offset=k 的位置插入一个元素的时间复杂度就降为 O(1)。

### 数组删除的时间复杂度分析

假设数组长度为 n，需要删除 offset=k 位置上的数据，那么时间复杂度是多少？

**分析：**

与数组插入类似，删除一个元素这个操作的时间复杂度为 O(1)。重点是分析删除数据之后，为了保持连续性而需要做的大量数据的搬移。

**结论：**

* 最好情况时间复杂度：删除末尾元素，O(1)
* 最坏情况时间复杂度：删除开头元素：O(n)
* 平均情况时间复杂度：(1+2+...+n)/n=O(n)

**改进的办法：**

删除 offset=k 元素的平均情况时间复杂度为 O(n)，如果多次删除，那么就会有多个 O(n) 的工作量出现。这种情况下，在每次删除时只是记录需要被删除的元素的位置， 然后将真正的删除操作集中执行，那么删除的效率会不会提高很多？因为多次删除的数据搬移工作是一次性完成的。这就是 JVM 标记清除垃圾回收算法的核心思想。 

### 数组的访问越界问题

* 在 C 语言中，只要不是访问受限的内存，所有的内存空间都是可以自由访问的。
* 数组越界在 C 语言中是一种未决行为，并没有规定数组访问越界时编译器应该如何处理。因为访问数组的本质就是访问一段连续内存，只要数组通过偏移计算得到的内存地址是可用的，那么程序就可能不会报任何错误。
* 并非所有的语言都像 C 一样，把数组越界检查的工作丢给程序员去做，像 Java 本身就会做越界检查。

### 容器类 VS 数组

许多编程语言都提供了数组这一种数据类型，但是除此之外，它们还提供了容器类。比如，Java 提供了 ArrayList， C++ STL 提供了 vector。那么在项目开发中，什么时候适合使用数组，什么时候适合使用容器类？这里使用 Java 中的 ArrayList 进行举例说明。

**ArrayList 的优势：**

* ArrayList 的最大优势就是可以将很多数组操作的细节封装起来。比如，数组插入、删除数据时需要搬移其他数据等。
* ArrayList 支持动态扩容。
  * 扩容操作涉及内存申请和数据搬移，在使用 ArrayList 时，最好能在创建 ArrayList  时指定大小。

**使用数组的时机：**

* Java ArrayList 无法存储基本类型，比如 int、long，需要封装为 Integer、Long 类，而 Autoboxing、Unboxing 会有一定的性能消耗，所以如果特别关心性能，或者希望使用基础数据类型就可以选用数组。
* 如果数据大小事先已知，并且对数据的操作非常简单，用不到 ArrayList 提供的大部分方法，也可以直接使用数组。
* 个人喜好：表示多维数组时，使用数组往往更加直观，比如 `Object[][] array`； 而使用容器类则需要定义为：`ArrayList<ArrayList> array`。


**补充学习：**

* 研究《Java 核心技术卷一》关于数组和 ArrayList 的内容。
